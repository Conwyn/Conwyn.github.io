# GCE

Colab Swift GDrive Service Account

Background FAST.AI provided a wonderful course in 2019 in two parts. The second part introduced Swift. 
Swift is a standard 3G language with lots of safety checks to stop me making all the mistakes I normally make when learning a new language. 
Unfortunately "How do I do?" involves Google and guess.

Colab is a free resource of server with GPU from Google but you only have a fresh local drive.

Google drive  (Gdrive) is a 15GB free resource where you can store data.

FAST.AI generally uses Python. Python running on Colab allows you to connect to your Google Drive. 
GDrive Colab and Python - a great combination. 
Python invokes Gdrive authentication which invokes a data entry box into which you sign and returns a token.
You paste the token into Colab and everything is fine.

So all we need to do is write similar functionality for Swift and we have a great combination but with the power of Swift.

So I will write a program and ask you to type in your Google userid and password and then I can ask Google to give me complete access to your Gdrive.

I can not seeing that being too popular.

Fear not Google to the rescue. You can have a service acccount as well as your normal Google userid. Service accounts have a e-mail like userid and a private key rather than a password. You can pick a Google folder on your Gdrive and allow access to the service account using the email like userid.

You can disable your individual service account from your collection.

To use the service account to access the GDrive you build a request called a JWT which is signed with the private key and has a maximum life of 60 minutes.

The service account administration is found at https://console.developers.google.com

So we can access the Gdrive but how?

Enter the Google API. This is a series of GET POST PUT request using HTTP which you can issue from Swift URLSession request.

Swift is great for mobile phones because it just waits for input from the screen or an event. 

A program running on Colab has to wait for the Swift URLSession to complete, examine the HTTP status information and process any response.

I hope this is the correct method of referral. A gentleman called pcuenca has written a export import function for Swift Colab similar to Python.

This allows the Jupyter notebook to be marked with "// export" in individual cells and pcuenca (https://github.com/latenitesoft/NotebookExport) generates a Package.swift and main.swift  which can be imported into the next notebook using 

%install '.package(path: "/content/FastaiNotebook_ExportTest")' FastaiNotebook_ExportTest

The problem with Colab is the server is empty and /content contains nothing.

So here is an outline of the solution

// export
Save the notebook on your GDrive
Copy the notebook to /content

Allow pcuena to generate the Package and main on /content by reading the notebook on /content. It is a JSON file.
Copy the Package and main to your Gdrive

Start a new notebook.
Copy the files back to /content
Restart the notebook
Add to the first cell

%install '.package(path: "/content/FastaiNotebook_ExportTest")' FastaiNotebook_ExportTest
import FastaiNotebook_ExportTest

%install recursive follows the imports so it is necesary to copy all the exported data from GDrive 





